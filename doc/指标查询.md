# 指标查询

## 配置Prometheus

在 prometheus.yml 文件加入

```
job_name: 'x-monitor-data'
scrape_interval: 1s
metrics_path: "x-monitor/metrics"
static_configs:
  - targets: ['127.0.0.1:31078']
```

## 启动Prometheus

```
./prometheus --log.level=debug
```

## 查询x-monitor导出的指标

1. 直接查询

   ```
   curl 0.0.0.0:31079/metrics
   ```

2. 通过envoy代理访问

   ```
   curl 127.0.0.1:31078/x-monitor/metrics
   ```

## 在Prometheus中查询指标

```
node_cpus_jiffies_total{cpu="7",mode="total"}[5m]
{__name__=~"loadavg_15min|loadavg_1min|loadavg_5min"}
{host="localhost.localdomain:8000"}
{meminfo!=""} 查看所有meminfo标签指标
{psi!=""} 查看所有psi指标
{vmstat!=""} 查看vmstat指标
```

